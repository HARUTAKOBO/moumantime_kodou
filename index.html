<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ãƒ©ã‚¤ãƒäº‰å¥ªæˆ¦ ãƒ‡ãƒãƒƒã‚°STEP2ï¼ˆãƒãƒƒãƒ—é‡ã­ï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
body{margin:0;font-family:system-ui;background:#111;color:#fff}
h1{font-size:16px;margin:8px}
.wrap{display:grid;grid-template-columns:260px 1fr;height:100vh}
.panel{background:#222;padding:12px}
label{font-size:12px;color:#ccc}
input,button{width:100%;margin:6px 0;padding:6px}
canvas{background:#000}
</style>
</head>
<body>
<h1>ğŸ ãƒ‡ãƒãƒƒã‚°STEP2ï¼šmap.png ã‚’è–„ãé‡ã­ã¦ç¢ºèª</h1>
<div class="wrap">
<div class="panel">
<label>é€Ÿåº¦</label>
<input id="speed" type="number" value="2">
<label>ãƒãƒƒãƒ—é€æ˜åº¦</label>
<input id="alpha" type="number" step="0.1" min="0" max="1" value="0.6">
<button id="reset">ãƒªã‚»ãƒƒãƒˆ</button>
<p style="font-size:12px;line-height:1.4">
ãƒ»map.png ã¯ index.html ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«ç½®ã<br>
ãƒ»è¦‹ãˆãªããªã£ãŸã‚‰é€æ˜åº¦ã‚’ä¸‹ã’ã‚‹
</p>
</div>
<canvas id="field" width="900" height="1200"></canvas>
</div>
<script>
// ===== STEP2: ãƒãƒƒãƒ—é‡ã­ =====
const canvas = document.getElementById('field');
const ctx = canvas.getContext('2d');
const speedEl = document.getElementById('speed');
const alphaEl = document.getElementById('alpha');

const bg = new Image();
bg.src = 'map.png'; // åŒéšå±¤

const horses = [
  {name:'æ¡‚å·', color:'#ff4d4d', x:100, y:200},
  {name:'å¯¿å·', color:'#4dff4d', x:200, y:300},
  {name:'æ±Ÿå·', color:'#4d4dff', x:300, y:400},
  {name:'æ¶ªå·', color:'#ffd24d', x:400, y:500},
  {name:'æ°¸å·', color:'#ff4dff', x:500, y:600},
  {name:'å…‰å·', color:'#4dffff', x:600, y:700}
];

let t = 0;

function draw(){
  // èƒŒæ™¯ãƒ™ãƒ¼ã‚¹ï¼ˆå¿…ãšè¦‹ãˆã‚‹ï¼‰
  ctx.fillStyle = '#203040';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // ãƒãƒƒãƒ—ï¼ˆã‚ã‚Œã°è–„ãï¼‰
  if(bg.complete && bg.naturalWidth>0){
    ctx.save();
    ctx.globalAlpha = Number(alphaEl.value);
    ctx.drawImage(bg,0,0,canvas.width,canvas.height);
    ctx.restore();
  } else {
    ctx.fillStyle='#fff';
    ctx.fillText('map.png ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',20,30);
  }

  // 6è‰²ã®ä¸¸ï¼ˆå¸¸ã«æœ€å‰é¢ï¼‰
  horses.forEach((h,i)=>{
    const dx = (t + i*50) % 600;
    const dy = (t + i*30) % 400;
    const x = h.x + dx;
    const y = h.y + dy;

    ctx.fillStyle = h.color;
    ctx.beginPath();
    ctx.arc(x,y,12,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle = '#000';
    ctx.fillText(h.name, x+14, y);
  });

  t += Number(speedEl.value);
  requestAnimationFrame(draw);
}

requestAnimationFrame(draw);

document.getElementById('reset').onclick = ()=>{t=0;};
</script>
</body>
</html>
